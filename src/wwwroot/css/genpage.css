/*
This file is part of SwarmUI, a WebUI for Stable Diffusion.

Copyright 2022-2024 Stability AI and the SwarmUI project authors.
All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
you may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
/* Global structural refinements for consistent, modular UI */
/* NOTE: CSS variables have been moved to design-tokens.css for consistency */

/* ========================================
   GENPAGE ROOT LAYOUT
   Full-height layout structure
   ======================================== */

/* Full-height layout setup for body and html */
html {
    height: 100%;
}

body {
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Ensure navbar and other fixed elements don't interfere */
.navbar {
    margin-bottom: 0;
    flex-shrink: 0;
}

/* Status bar and toasts should be positioned absolutely */
.top-status-bar-wrapper,
.center-toast,
#version_display {
    position: fixed;
}

/* Subnav bar should not take space if hidden */
#subnav_bar {
    flex-shrink: 0;
}

/* Container fluid should fill available space after navbar */
.container-fluid {
    flex: 1;
    min-height: 0;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
}

/* Main content container should fill viewport - use flex instead of 100vh */
.container-fluid:has(.tab-content.tab-hundred) {
    height: auto;
    min-height: 0;
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Top-level tab content container */
.tab-content.tab-hundred {
    flex: 1;
    min-height: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* All top-level tab panes */
.tab-content.tab-hundred > .tab-pane {
    display: none;
    flex: 1;
    min-height: 0;
    overflow: hidden;
}

/* Only show active tab pane */
.tab-content.tab-hundred > .tab-pane.show.active,
.tab-content.tab-hundred > .tab-pane.active {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
}

/* ========================================
   SPLIT BAR SYSTEM
   Draggable dividers for layout sections
   ======================================== */

.splitter-bar {
    display: inline-block;
    background-color: var(--bs-border-color);
    margin: 0px;
}

.large-window .splitter-bar:hover {
    background-color: var(--bs-primary);
    box-shadow:
      -0.5rem 0 0.5rem 0 color-mix(in srgb, transparent 50%, var(--bs-primary)),
      0.5rem 0 0.5rem 0 color-mix(in srgb, transparent 50%, var(--bs-primary));
}

/* Vertical split bars (left and right sidebars) */
.t2i-top-split-bar,
#t2i-top-split-bar,
#t2i-top-2nd-split-bar {
    height: 50vh;
    width: 5px;
    cursor: col-resize;
}

#t2i-top-split-bar:hover,
#t2i-top-2nd-split-bar:hover {
    background-color: var(--bs-primary);
}

/* Horizontal split bar (bottom section) */
.t2i-mid-split-bar,
#t2i-mid-split-bar {
    width: 100vw;
    height: 5px;
    cursor: row-resize;
}

#t2i-mid-split-bar:hover {
    background-color: var(--bs-primary);
    box-shadow:
      0 -0.5rem 0.5rem 0 color-mix(in srgb, transparent 50%, var(--bs-primary)),
      0 0.5rem 0.5rem 0 color-mix(in srgb, transparent 50%, var(--bs-primary));
}

/* Split bar toggle buttons */
.t2i-split-quickbutton {
    position: relative;
    font-size: 200%;
    cursor: pointer;
    border-radius: 0.2rem;
    color: var(--bs-body-color);
}

.t2i-split-quickbutton:hover {
    background-color: var(--bs-primary);
}

.small-window .t2i-split-quickbutton {
    display: none;
}

#t2i-top-split-quickbutton,
.t2i-top-split-quickbutton {
    float: right;
    vertical-align: top;
    top: 0rem;
    left: 0.6rem;
}

#t2i-mid-split-quickbutton,
.t2i-mid-split-quickbutton {
    float: right;
    vertical-align: top;
    top: 0rem;
    right: 2rem;
}

/* Image editor split bar */
.t2i-top-imageeditor-bar,
#image_editor_sizebar {
    width: 5px;
    height: 50vh;
    cursor: col-resize;
    vertical-align: top;
}

#image_editor_sizebar:hover {
    background-color: var(--bs-primary);
}

/* ========================================
   GENERATE PAGE ROOT LAYOUT
   Fixed comprehensive layout structure
   ======================================== */

/* Root container - fills viewport minus navbar */
.d-flex.flex-column.h-100 {
    height: 100%;
    min-height: 0;
    overflow: hidden;
    display: flex !important;
    flex-direction: column;
    padding: 0.5rem;
    gap: 0.5rem;
}

/* Main 3-column row */
.d-flex.flex-column.h-100 > .row.g-3 {
    flex: 1 1 0;
    min-height: 0;
    overflow: hidden;
    margin: 0 !important;
    gap: 0.75rem;
}

/* Each column should fill height */
.d-flex.flex-column.h-100 > .row.g-3 > div[class*="col-"] {
    height: 100%;
    min-height: 0;
    display: flex;
    flex-direction: column;
    padding: 0 0.375rem;
}

/* Inner column containers */
.d-flex.flex-column.h-100 > .row.g-3 > div[class*="col-"] > div {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Tab content - consolidated base styles */
.tab-content {
    flex: 1 1 auto;
    min-height: 0;
    overflow: hidden;
    white-space: normal;
}

/* Tab pane base styles with fade transition */
.tab-pane {
    min-height: 0;
    height: 100%;
    display: none;
    opacity: 0;
    transition: opacity var(--duration-200) var(--ease-in-out);
}

/* Active tab panes should display with fade-in */
.tab-pane.show.active,
.tab-pane.active {
    display: block;
    opacity: 1;
}

/* Remove excessive padding from tab panes - but allow bottom tabs */
.tab-pane:not(.genpage-bottom-tab) {
    padding: 0;
}

/* Global hover effect standardization */
.btn,
.nav-link,
.basic-button,
button:not(:disabled),
a.interactive {
    transition: all var(--duration-150) var(--ease-in-out);
}

/* Ensure nested tab panes (inside any tab) remain visible if active */
.genpage-bottom-tab.show.active,
.tab-pane.show.active .tab-pane.show.active,
.tab-pane .tab-pane.show.active {
    display: block;
}

/* Genpage bottom tabs - ensure proper display */
.genpage-bottom-tab {
    display: none;
    flex: 1;
    min-height: 0;
    overflow: hidden;
    flex-direction: column;
}

.genpage-bottom-tab.show.active,
.genpage-bottom-tab.active {
    display: flex;
}

/* Ensure secondary tab list stays hidden - it's for routing only */
#toptablist {
    display: none;
}

/* ========================================
   TOP-LEVEL TAB PAGES
   Server, User, Utilities tabs
   ======================================== */

#server_tab,
#user_tab,
#utilities_tab,
#Simple {
    height: 100% !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    padding: 1rem;
    /* Do NOT force display here; visibility is controlled by tab active state */
}

/* When active, these top-level panes should be flex containers */
.tab-content.tab-hundred > #server_tab.show.active,
.tab-content.tab-hundred > #user_tab.show.active,
.tab-content.tab-hundred > #utilities_tab.show.active,
.tab-content.tab-hundred > #Simple.show.active {
    display: flex !important;
    flex-direction: column;
}

/* Nested tab content within top-level tabs */
#server_tab > .tab-content,
#user_tab > .tab-content,
#utilities_tab > .tab-content {
    flex: 1 1 auto;
    display: flex !important;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

/* Nested tab panes */
#server_tab .tab-pane,
#user_tab .tab-pane,
#utilities_tab .tab-pane {
    flex: 1;
    overflow-y: auto;
}
.modal-body {
    white-space: normal;
}
.prompt-box {
    width: 100%;
    border-radius: 0.5rem;
}
.generate-button {
    background-color: var(--bs-primary);
    color: var(--bs-white);
    border: 1px solid var(--bs-primary);
    font-size: 150%;
    font-weight: bold;
    padding-top: 0.2rem;
    padding-bottom: 0.2rem;
    text-align: center;
    border-radius: 1rem;
    width: calc(90% - 2rem);
    margin-left: 5%;
    margin-bottom: 0.5rem;
    margin-top: 0.5rem;
}
.legacy-interrupt {
    font-size: 150%;
    font-weight: bold;
    padding-top: 0.2rem;
    padding-bottom: 0.2rem;
    margin-bottom: 0.5rem;
    margin-top: 0.5rem;
}
.generate-button:hover {
    background-color: var(--bs-primary-border-subtle);
    color: var(--bs-white);
}
.interrupt-button {
    background-color: var(--bs-danger);
    color: var(--bs-white);
    border: 1px solid var(--bs-danger);
    font-weight: bold;
    padding: 0.2rem;
    border-radius: 0.7rem;
    min-width: 2rem;
    margin-left: 0;
}
.interrupt-button-none {
    background-color: color-mix(in srgb, transparent 80%, var(--bs-danger));
    opacity: 0.4;
}
.interrupt-button:hover {
    background-color: var(--bs-danger);
    color: var(--bs-white);
}
/* Sub-navigation within pages (in-content subnav) */
.swarm-gen-tab-subnav {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
}
.advanced_input_checkbox {
    width: calc(100% - 2rem);
    margin-left: 1rem;
    margin-right: 1rem;
    text-align: center;
    background-color: var(--bs-tertiary-bg);
    margin-top: 1rem;
    margin-bottom: 1.5rem;
    cursor: pointer;
    position: relative;
    bottom: 2.25rem;
}
.advanced_input_checkbox_presets {
    bottom: 0rem;
}
.main_inputs_area_hidden {
    display: none;
    visibility: hidden;
}

/* ========================================
   LEFT SIDEBAR - Parameter Inputs
   ======================================== */

/* Main inputs wrapper - fills available space, scrollable */
#main_inputs_area_wrapper,
.main_inputs_area_wrapper {
    flex: 1;
    min-height: 0;
    overflow-x: hidden;
    overflow-y: auto;
    white-space: normal;
    padding: 0.5rem;
    padding-right: 1rem;
    width: 100%;
    /* Smooth scrolling */
    scrollbar-width: thin;
    scrollbar-color: var(--bs-border-color) transparent;
}

/* Webkit scrollbar styling for input sidebar */
/* Scrollable inputs area - uses .custom-scrollbar class from components.css */
#main_inputs_area {
    flex: 1 1 auto !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    padding: 0.5rem;
    min-height: 0 !important;
}

/* Filter at top - fixed height */
.input_filter_container {
    flex: 0 0 auto !important;
    min-height: auto;
    padding: 0.5rem !important;
}

/* Advanced checkbox at bottom - fixed height */
.advanced_input_checkbox {
    flex: 0 0 auto;
    min-height: auto;
    padding: 0.75rem;
    border-top: 1px solid var(--bs-border-color);
    background-color: var(--bs-tertiary-bg);
    margin-top: auto;
}
/* ========================================
   CENTER AREA - Image Display
   ======================================== */

/* Current image container */
.current_image,
#current_image {
    flex: 1;
    min-height: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    border: 1px solid var(--bs-border-color);
    border-radius: 0.5rem;
    background-color: var(--bs-secondary-bg);
    overflow: auto;
    position: relative;
}

/* Ensure images don't get clipped */
#current_image img,
#current_image video,
.current_image img,
.current_image video {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

/* Top bar container should be a flex row */
.t2i-top-bar-container {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    overflow: hidden;
    padding: 0;
}

/* Top bar should display children in a row */
.t2i-top-bar,
#t2i_top_bar {
    display: flex !important;
    flex-direction: row !important;
    flex: 1;
    min-height: 0;
    overflow: hidden;
    align-items: stretch;
    width: 100%;
}

/* Input sidebar - left column */
.input-sidebar,
#input_sidebar {
    flex: 0 0 auto;
    min-width: 300px;
    max-width: 350px;
    width: auto;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    height: 100%;
}

/* Input sidebar tab content - scrollable */
#input_sidebar .tab-content,
#inputsidebartab_content {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Input sidebar tab pane - scrollable */
#input_sidebar .tab-pane,
#Input-Sidebar-Main-Tab {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Split bars - fixed width, no flex */
.t2i-top-split-bar,
#t2i-top-split-bar,
#t2i-top-2nd-split-bar {
    flex: 0 0 5px;
    min-width: 5px;
    max-width: 5px;
    width: 5px;
}

/* Main image area - center column, takes remaining space */
.main-image-area,
#main_image_area {
    flex: 1 1 auto !important;
    min-width: 0;
    max-width: none;
    width: auto;
    display: flex !important;
    flex-direction: column !important;
    overflow: visible;
    position: relative;
}

/* Image wrap box - fills space above prompt */
#current_image_wrapbox,
.current_image_wrapbox {
    flex: 1 1 auto;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Image Result Tab should fill its container */
#Image-Result-Tab {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: visible;
}

/* Legacy inline-block styles removed - breaks flexbox layout */
.current-image-data {
    white-space: wrap;
    font-size: 80%;
}
.current-image-img {
    max-width: 100%;
    max-height: calc(max(15rem, 100% - 5rem));
    object-fit: contain;
    object-position: top left;
}
/* ========================================
   RIGHT SIDEBAR - Batch Images
   ======================================== */

/* Batch wrapper - right column, fixed width for gallery */
.current_image_batch,
#current_image_batch_wrapper {
    flex: 0 0 350px !important;
    min-width: 300px;
    max-width: 400px;
    width: 350px;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden;
    order: 999; /* Ensure it stays on the right */
    position: relative;
    visibility: visible !important;
}

/* Batch core - compact flex grid gallery */
.current_image_batch_core,
#current_image_batch {
    display: grid;
    grid-template-columns: repeat(var(--batch-grid-columns, 3), 1fr);
    gap: 0.5rem;
    padding: 0.5rem;
    overflow-y: auto;
    overflow-x: hidden;
    align-content: start;
    background-color: var(--bs-secondary-bg);
    border-radius: 0.375rem;
    flex-wrap: nowrap;
    flex: 1;
    min-height: 0;
}

/* Image blocks in batch - compact gallery style */
#current_image_batch .image-block,
.current_image_batch_core .image-block {
    position: relative;
    width: 100%;
    min-height: 100px;
    display: flex;
    flex-direction: column;
    border-radius: 0.375rem;
    overflow: hidden;
    cursor: pointer;
    transition: transform var(--duration-200) var(--ease-in-out), box-shadow var(--duration-200) var(--ease-in-out);
    background-color: var(--bs-tertiary-bg);
    border: 1px solid var(--bs-border-color);
}

/* Hover effect for gallery images */
#current_image_batch .image-block:hover,
.current_image_batch_core .image-block:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    z-index: 10;
}

/* Selected state for keyboard navigation */
#current_image_batch .image-block.selected,
.current_image_batch_core .image-block.selected {
    outline: 3px solid var(--bs-primary);
    outline-offset: -3px;
    z-index: 15;
}

/* Images in gallery blocks - preserve aspect ratio */
#current_image_batch .image-block img,
#current_image_batch .image-block video,
.current_image_batch_core .image-block img,
.current_image_batch_core .image-block video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
}

/* Metadata overlay in gallery view - show on hover */
#current_image_batch .image-preview-text,
.current_image_batch_core .image-preview-text {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.85);
    color: var(--bs-white);
    padding: var(--space-2);
    font-size: var(--text-xs);
    line-height: var(--leading-tight);
    opacity: 0;
    transform: translateY(100%);
    transition: opacity var(--duration-200) var(--ease-in-out),
                transform var(--duration-200) var(--ease-in-out);
    pointer-events: none;
    z-index: 5;
}

/* Show metadata on hover */
#current_image_batch .image-block:hover .image-preview-text,
.current_image_batch_core .image-block:hover .image-preview-text {
    opacity: 1;
    transform: translateY(0);
}
.current-image-extras-wrapper {
    min-width: 20rem;
    vertical-align: top;
    margin-left: 0.5rem;
    margin-right: 0.5rem;
    max-height: 10rem;
}
.extras-wrapper-sideblock .current-image-data {
    text-align: left;
}
.extras-wrapper-sideblock .param_view_block {
    width: calc(100% - 10px);
}
.batch-gear-button {
    height: 1.6rem;
    position: absolute;
    top: -0.2rem;
    left: 0;
    width: fit-content;
    padding: 0.1rem;
    color: color-mix(in srgb, var(--bs-body-color) 70%, var(--bs-body-bg));
    background-color: color-mix(in srgb, transparent 50%, var(--bs-body-bg));
    border-radius: 0.4rem;
    transition: all var(--duration-500) var(--ease-out);
    cursor: pointer;
}
.batch-gear-button:hover {
    color: var(--bs-body-color);
    background-color: var(--bs-primary);
}
.image-block {
    display: inline-block;
    cursor: pointer;
}
.image-block img, .img-block video {
    display: block;
    margin: auto;
}
.image-block-placeholder img {
    filter: blur(5px);
}
.current_image_placeholder img {
    filter: blur(10px);
}
.image-block-legacy {
    position: relative;
    height: 11.5rem;
    width: 10rem;
    padding-top: 0.1rem;
    padding-left: 0.1rem;
    padding-right: 0.1rem;
    overflow: hidden;
    white-space: pre-wrap;
    word-break: break-all;
}
.image-block-small {
    height: 7rem;
    width: 7rem;
}
.image-block-big {
    height: 17.5rem;
    width: 16rem;
}
.image-block-giant {
    height: 27.5rem;
    width: 26rem;
}
.image-block-legacy img {
    height: 8rem;
}
.image-block-small img {
    height: 5rem;
}
.image-block-big img {
    height: 15rem;
}
.image-block-giant img {
    height: 25rem;
}
.image-block-batch {
    width: calc(10rem + 2px);
    padding: 1px;
    display: inline-block;
    overflow: hidden;
}
.image-block-batch img, .image-block-batch video {
    max-height: 100%;
    width: 100%;
}
.image-block:hover {
    background-color: var(--bs-primary);
}
.image-block-starred {
    box-shadow: 0 0 1px 1px var(--star);
}
.image-block .loading-spinner-parent {
    width: 0;
    height: 0;
    top: -10rem;
    left: calc(50% - 5rem);
    position: relative;
}
.image-block .loading-spinner {
    position: absolute;
    width: 10rem;
    height: 10rem;
}
.image-block-failed {
    height: 0;
    width: 0;
    top: -5rem;
    left: calc(50% - 5rem);
    position: relative;
}
.image-block-failed::before, .image-block-failed::after {
    position: absolute;
    content: '';
    width: 10rem;
    height: 1rem;
    background-color: var(--bs-primary);
}
.image-block-failed::before {
    transform: rotate(45deg);
}
.image-block-failed::after {
    transform: rotate(-45deg);
}
.image-block.image-block-current {
    outline: 3px solid var(--box-selected-border-stronger);
}
.image-batch-0 {
    background-color: var(--batch-0);
}
.image-batch-1 {
    background-color: var(--batch-1);
}
.image-batch-folder {
    width: 6rem;
    height: 6rem;
}
.image-batch-folder img {
    height: 3.5rem;
}
.image-preview-text-small {
    font-size: 70%;
}
.image-preview-text-medium {
    font-size: 80%;
}
.image-preview-text-large {
    font-size: 90%;
}
.image-preview-text {
    font-family: var(--font-monospace);
    min-width: 100%;
    max-width: 0;
}
.current_model_view {
    display: inline-block;
    border: 1px dotted var(--bs-border-color);
    background-color: var(--bs-tertiary-bg);
    border-radius: 0.3rem;
    padding-left: 0.2rem;
    padding-right: 0.2rem;
}
.model-block {
    height: 10rem;
    width: 30rem;
    margin: 0.2rem;
    display: inline-block;
    overflow: hidden;
    white-space: nowrap;
    vertical-align: top;
    position: relative;
    border: 1px solid var(--bs-border-color);
}
.model-block img {
    max-height: 9rem;
    width: 9rem;
    height: 9rem;
    display: inline-block;
    margin: 0.5rem;
    margin-bottom: 0px;
    vertical-align: top;
    cursor: pointer;
    object-fit: contain;
    background-color: var(--bs-tertiary-bg);
}
.model-descblock {
    width: 19.5rem;
    height: 10rem;
    overflow: hidden;
    scrollbar-gutter: stable;
    display: inline-block;
    white-space: normal;
    word-break: normal;
    overflow-wrap: break-word;
    font-size: 80%;
}
.model-descblock:focus {
    overflow: auto;
}
.model-block img:hover {
    border: 2px solid var(--bs-primary);
}
.model-block-small {
    height: 8rem;
    width: 22rem;
    margin: 0.1rem;
}
.model-block-big {
    height: 15rem;
    width: 40rem;
}
.model-block-small .model-descblock {
    width: 14rem;
    height: 8rem;
}
.model-block-big .model-descblock {
    width: 25rem;
    height: 15rem;
    word-break: normal;
}
.model-block-small img {
    max-height: 7rem;
    width: 7rem;
    height: 7rem;
}
.model-block-big img {
    max-height: 14rem;
    width: 14rem;
    height: 14rem;
}
.model-block-menu-button {
    display: block;
    position: absolute;
    top: 0.1rem;
    right: 0.4rem;
    font-size: 120%;
    border: 1px solid transparent;
    padding-left: 0.2rem;
    padding-right: 0.2rem;
    border-radius: 0.2rem;
    opacity: 0.7;
    background-color: color-mix(in srgb, transparent 80%, var(--bs-body-bg));
    transition: background-color var(--duration-200) var(--ease-out);
}
.image-block:hover .model-block-menu-button {
    opacity: 1.0;
    background-color: color-mix(in srgb, transparent 50%, var(--bs-body-bg));
}
.model-block-menu-button:hover {
    opacity: 1.0;
    background-color: var(--bs-primary) !important;
    cursor: pointer;
    border: 1px solid var(--btn-primary-border);
    color: var(--bs-emphasis-color);
}
.model-selected {
    border: 1px solid var(--box-selected-border-stronger);
    background-color: var(--box-selected-background-stronger);
}
.model-loaded {
    border: 1px solid color-mix(in srgb, var(--bs-body-bg) 50%, var(--box-selected-border));
    background-color: color-mix(in srgb, var(--bs-body-bg) 50%, var(--box-selected-background));
}
.model-unavailable {
    opacity: 0.3;
}
.model-remote {
    background-color: var(--background-gray);
}
.model-starred img {
    box-shadow: 0 0 3px 1px color-mix(in srgb, var(--star) 50%, transparent);
}
.sui_popover_model {
    white-space: normal;
}
.sui_popover_model_button {
    display: block;
    width: 100%;
    cursor: pointer;
    padding-left: 3px;
    padding-right: 3px;
    color: var(--bs-body-color);
    text-decoration: none;
    min-height: 1.3rem;
    line-height: 1.3rem;
    margin-top: 0;
    margin-bottom: 0;
    padding-top: 0;
    padding-bottom: 0;
}
.sui_popover_text_input {
    display: block;
    width: 100%;
    padding-left: 3px;
    padding-right: 3px;
    color: var(--bs-body-color);
    text-decoration: none;
    margin-bottom: 0.5rem;
    margin-top: 0.5rem;
    border-bottom: 1px solid var(--bs-border-color);
    height: 1.3rem;
}
.sui_popover_model_button_selected {
    background-color: color-mix(in srgb, var(--bs-primary) 50%, var(--bs-body-bg));
}
.sui_popover_model_button_add_all {
    padding-bottom: 0.1rem;
    border-bottom: 1px solid var(--bs-border-color);
    margin-bottom: 0.1rem;
}
.sui_popover_model_button:hover {
    background-color: var(--bs-primary);
    color: var(--bs-white);
}
.sui-popover-inline-block {
    white-space: nowrap;
    max-width: 100%;
    display: flex;
    align-items: baseline;
}
.sui-popover-inline-block input {
    flex-shrink: 1;
    flex-grow: 1;
}
.sui_popover_scrollable {
    max-height: 15rem;
    overflow-y: auto;
}
.sui_popover_scrollable_tall {
    max-height: calc(max(15rem, 45vh));
    overflow-y: auto;
}
.sui_popover_reverse {
    display: flex;
    flex-direction: column-reverse;
}
.model_filename {
    font-size: 80%;
    color: var(--bs-secondary-color);
}
.refresh-button {
    margin: 0.5rem;
    background-color: var(--btn-primary-bg);
    color: var(--btn-primary-color);
    border-radius: 0.5rem;
    border: 1px solid var(--btn-primary-border);
    min-width: 2rem;
}
.refresh-button:hover {
    background-color: var(--btn-primary-hover-bg);
    color: var(--btn-primary-color);
}
.refresh-button:disabled {
    background-color: var(--bs-secondary-bg);
    color: var(--bs-secondary-color);
}
.tool-container .tool {
    display: none;
}
.tool-container .tool-open {
    display: block !important;
}
.tool-container {
    border-radius: 1rem;
    margin-top: 0.5rem;
    width: 95%;
    margin-left: 2.5%;
    padding: 0.5rem;
    border: 1px solid var(--bs-border-color);
}
.tool-selector {
    margin-top: 0.5rem;
    width: 90%;
    margin-left: 5%;
}
.modal_error_bottom {
    color: var(--bs-danger);
}
.modal_success_bottom {
    color: var(--bs-success);
}
#add_preset_modal {
    max-height: calc(95vh - var(--bs-modal-margin));
    margin-top: var(--bs-modal-margin);
}
#add_preset_modal .modal-dialog {
    margin-top: 0;
    margin-bottom: 0;
    height: 100%;
}
#add_preset_modal .modal-content {
    height: 100%;
}
#add_preset_modal .modal-body {
    overflow-y: auto;
}
/* Comfy-only elements are only visible within the Comfy tab */
.comfy-only { display: none; }
#Comfy .comfy-only { display: block; }
/* Ensure popovers layer above content */
.sui-popover, .sui-popover-notice {
    z-index: 1055;
}
.preset-block-selected {
    border: 1px solid var(--box-selected-border);
    background-color: var(--box-selected-background);
}
.preset-descblock {
    width: 20rem;
    word-wrap: normal;
    white-space: normal;
    word-break: normal;
}
.preset-in-list {
    display: inline-block;
    border: 1px solid var(--bs-border-color);
    padding-left: 0.5rem;
    border-radius: 1rem;
    border-right: none;
}
.lora-weight-input {
    width: 3rem;
}
.preset-remove-button {
    display: inline-block;
    color: var(--bs-body-color);
    font-weight: bold;
}
.preset-remove-button:hover {
    background-color: rgba(var(--bs-danger-rgb), 0.7);
}
.new_preset_image {
    align-items: center;
    text-align: center;
}
.new_preset_image img {
    max-width: 100%;
    max-height: 20rem;
}
.interrupt_line {
    display: block;
    width: 100%;
    white-space: normal;
}
.interrupt-line-part {
    display: inline-block;
}
.param_view_block {
    border-radius: 0.3rem;
    border: 1px solid var(--bs-border-color);
    display: inline-block;
    color: var(--bs-secondary-color);
    overflow: clip;
    text-overflow: ellipsis;
}
.param_view_block_model {
    background-color: rgba(var(--tag-color-rgb), 0.01);
}
.param_view {
    border-radius: 0.3rem;
    color: var(--bs-body-color);
}
.bottom-info-bar-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: flex-start;
    /* Removed problematic border-bottom that was causing horizontal line artifacts */
}
.bottom-info-bar-component {
    padding-left: 0.2rem;
    padding-right: 0.2rem;
    /* Reduced border opacity to minimize visual artifacts */
    border-left: 1px solid color-mix(in srgb, var(--bs-border-color) 30%, transparent);
}
.num_jobs_span {
    vertical-align: middle;
}
.path-list-part {
    border-bottom: 1px dotted var(--bs-body-color);
    cursor: pointer;
    margin-left: 0.2rem;
    margin-right: 0.2rem;
}
.group-toggler-switch {
    margin-left: 1rem;
    display: inline-block;
    margin-bottom: 0;
}
.settings-container {
    padding-left: 1rem;
    padding-top: 1rem;
}
.settings-group {
    margin-top: 2rem;
    padding-bottom: 0.2rem;
    padding-left: 2rem;
}
.setting-looks-wrong {
    border: 1px  solid var(--bs-danger) !important;
    box-shadow: 0px 0px 1px 1px var(--bs-danger) !important;
}
.group-label {
    position: relative;
    left: -1rem;
    margin-bottom: 0.7rem;
}
.input-group-closed .input-group-header-activated {
    background-color: rgba(var(--bs-primary-rgb), 0.1);
    border-radius: 0.5rem;
}
.input-group-open .input-group-header-activated {
    background-image: linear-gradient(rgba(var(--bs-primary-rgb), 0.1), transparent);
    border-radius: 0.5rem;
}
.imageview_popup_modal_background {
    font-family: var(--bs-font-monospace);
    background-color: rgba(50, 50, 50, 0.7);
}
.imageview_modal_imagewrap {
    height: calc(min(100vw, 100vh - 7rem));
    max-width: 95vw;
    overflow: hidden;
}
.imageview_popup_modal_img {
    height: 100%;
    position: relative;
    margin: auto;
}
.imageview_popup_modal_undertext {
    background-color: var(--bs-body-bg);
    overflow-wrap: break-word;
    height: 7rem;
    overflow-y: auto;
    text-align: center;
}
.imageview_modal_inner_div {
    max-width: 95vw;
    overflow: hidden;
    margin: auto;
}
/* Old legacy styles removed - using modern flexbox styles below instead */
.browser-header-count {
    color: var(--bs-secondary-color);
    font-size: 80%;
    margin-left: 0.5rem;
    opacity: 0.8;
}
/* Old legacy inline-block styles removed - using modern flexbox styles below instead */
/* But keep minimal backward compatibility for rendering */
.browser-folder-tree-splitter {
    display: inline-block;
    width: 5px;
    cursor: col-resize;
    background-color: var(--bs-border-color);
    transition: background-color var(--duration-200) var(--ease-in-out);
}

.browser-folder-tree-splitter:hover {
    background-color: var(--bs-primary);
}

/* Bottom tabs need full height */
.genpage-bottom-tab {
    height: 100% !important;
    display: flex !important;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
    position: relative;
    z-index: 10;
}

.genpage-bottom-tab .browser_container {
    flex: 1 1 auto;
    min-height: 0;
    height: auto !important;
    overflow: hidden;
    position: relative;
    z-index: 10;
}


/* ========================================
   FILE BROWSER LAYOUT
   Tree + content structure for bottom tabs
   ======================================== */

/* Browser container fills tab pane */
.browser_container {
    display: flex !important;
    flex-direction: row;
    height: 100% !important;
    min-height: 0 !important;
    overflow: hidden;
    background-color: var(--bs-body-bg);
    position: relative;
    z-index: 10;
}

/* Left tree navigation */
.browser-folder-tree-container {
    flex: 0 0 15rem;
    min-width: 12rem;
    max-width: 20rem;
    background-color: var(--bs-tertiary-bg);
    border-right: 1px solid var(--bs-border-color);
    padding: 0.5rem;
    overflow-y: auto;
    overflow-x: hidden;
    position: relative;
    z-index: 5;
    display: flex !important;
    flex-direction: column !important;
    visibility: visible !important;
}

/* Right content area */
.browser-fullcontent-container {
    flex: 1 1 auto;
    min-width: 0;
    padding: 0;
    background-color: var(--bs-body-bg);
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden;
    position: relative;
    z-index: 5;
    visibility: visible !important;
}

/* Browser header bar */
.browser-header-bar {
    flex: 0 0 auto;
    padding: 0.5rem;
    border-bottom: 1px solid var(--bs-border-color);
}

/* Browser content - scrollable */
.browser-content-container {
    flex: 1 1 auto;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0.5rem;
    background-color: var(--bs-body-bg);
    position: relative;
    z-index: 5;
    display: block !important; /* Ensure it's always visible */
    visibility: visible !important;
    opacity: 1 !important;
}

/* Ensure server tab manage_users components don't overlay bottom bar content */
/* The d-flex h-100 container inside Server-ManageUsers tab was overlaying everything */
#Server-ManageUsers .d-flex.h-100 {
    position: relative;
    z-index: 1;
    /* Constrain to tab pane only */
    max-height: 100%;
}

/* When Server-ManageUsers tab is NOT active, ensure its content doesn't display */
#Server-ManageUsers:not(.active):not(.show) {
    display: none !important;
}

/* CRITICAL: Aggressively hide the admin_user_filter that keeps appearing */
/* These should ONLY appear in the Server tab's ManageUsers section */
#Server-ManageUsers:not(.active) #admin_user_filter,
#Server-ManageUsers:not(.active) #admin_user_clear_input_icon,
#Server-ManageUsers:not(.show) #admin_user_filter,
#Server-ManageUsers:not(.show) #admin_user_clear_input_icon,
body:not([data-current-tab="server"]) #admin_user_filter,
body:not([data-current-tab="server"]) #admin_user_clear_input_icon {
    display: none !important;
    visibility: hidden !important;
    position: absolute !important;
    left: -9999px !important;
}

#manage_users_leftbox,
#manage_users_rightbox,
#manage_users_leftbox_content_rolelist,
#manage_users_leftbox_content_userlist,
#manage_users_rightbox_content {
    position: relative;
    z-index: auto;
}

.browser-folder-tree-part {
    padding: 0.375rem 0.75rem;
    margin: 0.125rem 0;
    border-radius: 0.375rem;
    cursor: pointer;
    -webkit-user-select: none;
    user-select: none;
    transition: all var(--duration-150) var(--ease-in-out);
    position: relative;
    font-size: 0.875rem;
    display: block;
    color: var(--bs-body-color);
}

.browser-folder-tree-part:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.1);
    color: var(--bs-primary);
    transform: translateX(2px);
}

.browser-folder-tree-part.selected {
    background-color: var(--bs-primary);
    color: var(--bs-white) !important;
    font-weight: 500;
    box-shadow: var(--shadow-sm);
}

/* Model blocks in file explorer view */
.model-block {
    background-color: var(--bs-body-bg);
    border-radius: 0.375rem;
    transition: all var(--duration-150) var(--ease-in-out);
    box-shadow: var(--shadow-xs);
}

.model-block:hover {
    background-color: var(--bs-secondary-bg);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
    border-color: var(--bs-primary);
}

/* Image blocks in batch/history */
.image-block {
    border-radius: 0.375rem;
    overflow: hidden;
    transition: all var(--duration-150) var(--ease-in-out);
    box-shadow: var(--shadow-xs);
}

.image-block:hover {
    transform: scale(1.02);
    box-shadow: var(--shadow-md);
    z-index: 10;
}

/* Tab content areas need proper structure */
.tab-content > .tab-pane {
    height: 100%;
}

/* Subnav styling */
.swarm-gen-tab-subnav {
    flex: 0 0 auto;
    border-bottom: 1px solid var(--bs-border-color);
    background-color: var(--bs-tertiary-bg);
    margin-bottom: 0 !important;
    padding: 0.25rem 0.5rem;
}

.swarm-gen-tab-subnav .nav-link {
    border-bottom: 2px solid transparent;
    transition: all var(--duration-150) var(--ease-in-out);
}

.swarm-gen-tab-subnav .nav-link.active {
    border-bottom-color: var(--bs-primary);
    background-color: transparent;
    font-weight: 500;
}

.swarm-gen-tab-subnav .nav-link:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.05);
}

/* Navigation System Improvements */
#navbarNav .nav-link.active {
    color: var(--bs-primary) !important;
    font-weight: 600;
    border-bottom: 2px solid var(--bs-primary);
    padding-bottom: calc(0.5rem - 2px);
}

#navbarNav .nav-link {
    transition: all var(--duration-150) var(--ease-in-out);
    border-bottom: 2px solid transparent;
}

#navbarNav .nav-link:hover {
    color: var(--bs-primary) !important;
    border-bottom-color: var(--bs-primary);
    opacity: 0.8;
}

/* Sub-navigation styling */
#subnav_bar {
    min-height: 48px;
}

#subnav_list .nav-link {
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    margin-right: 0.25rem;
    transition: all var(--duration-150) var(--ease-in-out);
}

#subnav_list .nav-link:hover {
    background-color: var(--bs-secondary-bg);
}

#subnav_list .nav-link.active {
    background-color: var(--bs-primary);
    color: var(--bs-white);
}

#subnav_hint {
    font-size: 0.875rem;
    opacity: 0.7;
}

/* ========================================
   BOTTOM BAR LAYOUT - Fixed structure
   ======================================== */

/* Bottom bar container - fixed height section */
#t2i_bottom_bar {
    flex: 0 0 auto;
    height: 280px;
    min-height: 220px;
    max-height: 35vh;
    display: flex !important;
    flex-direction: column;
    overflow: hidden;
    border-top: 1px solid var(--bs-border-color);
    border-radius: var(--bs-border-radius);
    background-color: var(--bs-secondary-bg);
    margin: 0 !important;
    margin-top: 0.5rem !important;
}

/* Bottom bar column (full width) */
#t2i_bottom_bar > .col-12 {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Bottom info bar - fixed height */
.bottom-info-bar-container {
    flex: 0 0 auto;
    height: auto;
    min-height: 40px;
}

/* Bottom bar tabs - fixed height */
#bottombartabcollection {
    position: relative;
    flex: 0 0 auto;
    display: flex;
    flex-wrap: wrap;
    background-color: var(--bs-tertiary-bg);
    border-bottom: 1px solid var(--bs-border-color);
    margin-bottom: 0;
    padding: 0.25rem 0.5rem;
    gap: 0.25rem;
}

/* Scroll indicator gradient when tabs overflow on mobile */
@media screen and (max-width: 768px) {
    #bottombartabcollection::after {
        content: '';
        position: absolute;
        right: 0;
        top: 0;
        bottom: 0;
        width: 3rem;
        background: linear-gradient(to left, var(--bs-tertiary-bg) 0%, transparent 100%);
        pointer-events: none;
        z-index: 2;
    }
}

#bottombartabcollection .nav-link {
    display: block;
    padding: 0.5rem 1rem;
    border-bottom: 2px solid transparent;
    border-radius: 0.375rem 0.375rem 0 0;
    transition: all var(--duration-150) var(--ease-in-out);
    cursor: pointer;
    position: relative;
    z-index: 1;
    white-space: nowrap;
}

#bottombartabcollection .nav-link.active {
    border-bottom-color: var(--bs-primary);
    background-color: var(--bs-body-bg);
    font-weight: 500;
    color: var(--bs-primary);
}

#bottombartabcollection .nav-link:hover {
    border-bottom-color: rgba(var(--bs-primary-rgb), 0.5);
    background-color: rgba(var(--bs-tertiary-bg-rgb), 0.5);
}

/* Bottom bar content area - fills remaining space */
#t2i_bottom_bar_content {
    flex: 1 1 auto;
    min-height: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    background-color: var(--bs-body-bg);
    position: relative;
    z-index: 1;
}

/* Bottom bar tab panes - ensure they display correctly */
#t2i_bottom_bar_content .tab-pane {
    display: none;
    flex: 1;
    min-height: 0;
    overflow: hidden;
    position: relative;
    z-index: 1;
}

#t2i_bottom_bar_content .tab-pane.show.active,
#t2i_bottom_bar_content .tab-pane.active {
    display: flex;
    flex-direction: column;
    z-index: 2;
}

/* Bottom info bar styling */
.bottom-info-bar-container {
    background-color: var(--bs-tertiary-bg);
    /* Removed border-bottom to prevent horizontal line artifacts */
}

.bottom-info-bar-component {
    font-size: 0.875rem;
    width: fit-content;
    cursor: pointer;
    /* Border already defined above with reduced opacity */
}
.browser-folder-tree-part-symbol {
    position: relative;
    width: 0;
}
.browser-folder-tree-part-open .browser-folder-tree-part-symbol::before {
    content: "\02B9F";
    position: absolute;
    left: -16px;
    width: 0;
}
.browser-folder-tree-part-closed .browser-folder-tree-part-symbol::before {
    content: "\02B9E";
    position: absolute;
    left: -16px;
    width: 0;
}
.browser-details-list-entry {
    display: block;
    width: 98%;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
    margin: auto;
    position: relative;
    cursor: pointer;
}
.browser-details-list-entry:hover {
    color: var(--bs-primary);
    text-decoration: underline;
}
.browser-details-list-entry-text {
    display: inline-block;
    width: 48%;
    height: 1.3rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    cursor: pointer;
    vertical-align: top;
}
.browser-details-list-entry img {
    max-height: 1.25rem;
    max-width: 1.25rem;
    display: inline-block;
    vertical-align: top;
    margin-right: 0.2rem;
}
.browser-list-entry {
    display: inline-block;
    max-width: 20rem;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
    margin: 0.3rem;
    position: relative;
    cursor: pointer;
}
.browser-list-entry-text {
    display: inline-block;
    max-width: 17rem;
    padding-right: 3rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    cursor: pointer;
    vertical-align: top;
}
.browser-list-entry-text:hover {
    color: var(--bs-primary);
    text-decoration: underline;
}
.browser-list-entry img {
    max-height: 1.25rem;
    max-width: 1.25rem;
    display: inline-block;
    vertical-align: top;
    margin-right: 0.2rem;
}
.browser-format-selector {
    margin-right: 0.5rem;
    border-radius: 0.2rem;
}
/* Prompt region - positioned below image, fixed height */
.alt_prompt_region,
#alt_prompt_region {
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    padding: 1rem;
    border-top: 1px solid var(--bs-border-color);
    background-color: var(--bs-tertiary-bg);
    margin-top: auto;
    width: 100%;
    box-sizing: border-box;
}

/* Prompt main line - modern layout */
.alt_prompt_main_line {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

/* Prompt textboxes container */
.alt_prompt_textboxes {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-left: 0;
}

/* Prompt input wrapper with history button */
.prompt-input-wrapper {
    position: relative;
    display: flex;
    align-items: flex-start;
}

.prompt-input-wrapper .alt_prompt_textbox {
    flex: 1;
    padding-right: 3rem;
}

.prompt-history-button {
    position: absolute;
    right: 0.5rem;
    top: 0.5rem;
    background: transparent;
    border: 1px solid var(--bs-border-color);
    border-radius: 0.25rem;
    padding: 0.375rem;
    cursor: pointer;
    color: var(--bs-body-color);
    transition: all var(--duration-150) var(--ease-in-out);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 2rem;
    min-height: 2rem;
}

.prompt-history-button:hover {
    background-color: var(--bs-tertiary-bg);
    border-color: var(--bs-primary);
    color: var(--bs-primary);
}

.prompt-history-button:active {
    transform: scale(0.95);
}

.prompt-history-button svg {
    display: block;
}

/* Prompt history dropdown */
.prompt-history-dropdown {
    background: var(--bs-body-bg);
    border: 1px solid var(--bs-border-color);
    border-radius: 0.5rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    max-width: 400px;
    min-width: 300px;
    max-height: 400px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.prompt-history-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-3);
    border-bottom: 1px solid var(--bs-border-color);
    font-weight: 600;
    background: var(--bs-tertiary-bg);
}

.prompt-history-close {
    background: transparent;
    border: none;
    font-size: 1.5rem;
    line-height: 1;
    cursor: pointer;
    color: var(--bs-body-color);
    padding: 0;
    width: 1.5rem;
    height: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.25rem;
    transition: all var(--duration-150) var(--ease-in-out);
}

.prompt-history-close:hover {
    background: var(--bs-danger);
    color: var(--bs-white);
}

.prompt-history-list {
    overflow-y: auto;
    flex: 1;
}

.prompt-history-item {
    padding: var(--space-3);
    border-bottom: 1px solid var(--bs-border-color);
    cursor: pointer;
    transition: background-color var(--duration-150) var(--ease-in-out);
}

.prompt-history-item:last-child {
    border-bottom: none;
}

.prompt-history-item:hover {
    background-color: var(--bs-tertiary-bg);
}

.prompt-history-text {
    font-size: var(--text-sm);
    color: var(--bs-body-color);
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    line-height: 1.5;
}

/* Prompt textareas - modern styling with auto-expand */
.alt_prompt_textbox,
#alt_prompt_textbox,
#alt_negativeprompt_textbox {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--bs-border-color);
    border-radius: 0.5rem;
    background-color: var(--bs-body-bg);
    color: var(--bs-body-color);
    resize: none;
    font-family: inherit;
    transition: border-color var(--duration-200) var(--ease-in-out), box-shadow 0.2s ease, height var(--duration-150) var(--ease-in-out);
    box-sizing: border-box;
    overflow-y: auto;
    min-height: 2.5rem;
    max-height: 300px;
}

.alt_prompt_textbox:focus,
#alt_prompt_textbox:focus,
#alt_negativeprompt_textbox:focus {
    outline: none;
    border-color: var(--bs-primary);
    box-shadow: 0 0 0 0.2rem rgba(var(--bs-primary-rgb), 0.25);
}

/* Prompt buttons wrapper - modern flex layout */
.alt-prompt-buttons-wrapper {
    display: flex;
    flex-direction: row;
    gap: 0.5rem;
    align-items: center;
    justify-content: flex-start;
}

/* Prompt buttons - modern styling */
.alt-prompt-buttons {
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all var(--duration-200) var(--ease-in-out);
    border: none;
    cursor: pointer;
}

.alt-prompt-generate-button {
    background-color: var(--bs-primary);
    color: var(--bs-white);
    flex: 1;
}

.alt-prompt-generate-button:hover {
    background-color: var(--bs-primary-border-subtle);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.alt-prompt-center-button {
    background-color: var(--bs-secondary);
    color: var(--bs-white);
    padding: 0.75rem;
    min-width: 3rem;
}

.alt-interrupt {
    background-color: var(--bs-danger);
    color: var(--bs-white);
    padding: 0.75rem;
    min-width: 3rem;
}

.alt-interrupt:hover {
    background-color: var(--bs-danger-border-subtle);
}

/* Token count - modern badge style */
.alt-text-tokencount-wrapper {
    display: flex;
    align-items: center;
    position: relative;
    width: auto;
    height: auto;
    left: auto;
}

.alt-text-tokencount {
    padding: 0.25rem 0.5rem;
    background-color: var(--bs-secondary-bg);
    border-radius: 0.375rem;
    font-size: 0.875rem;
    color: var(--bs-secondary-color);
    position: relative;
    top: auto;
    left: auto;
}
.alt-prompt-generate-button {
    border-top-right-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
    border-right: none !important;
    margin-left: 2px;
}
.alt-prompt-center-button {
    border-radius: 0 !important;
}
.alt-interrupt {
    margin-left: 0px;
    border-top-left-radius: 0 !important;
    border-bottom-left-radius: 0 !important;
    border-left: none !important;
}
.alt_prompt_extra_area {
    width: 100%;
}
.alt-prompt-added-image-area {
    max-width: calc(100% - 7rem);
}
.alt-prompt-image-container {
    display: inline-block;
    position: relative;
    background-color: rgba(var(--bs-body-bg-rgb), 0.2);
    transition: background-color var(--duration-200) var(--ease-out);
}

.alt-prompt-image {
    max-height: 128px;
    margin-right: 1px;
}

.alt-prompt-image-container-remove-button {
    position: absolute;
    top: 0;
    right: 0;
    background: rgba(var(--bs-danger-rgb), 0.7);
    color: white;
    border: none;
    border-radius: 50%;
    width: 1.5rem;
    height: 1.5rem;
    line-height: 1.5rem;
    text-align: center;
    cursor: pointer;
    font-weight: bold;
}

.alt-prompt-image-container:hover .alt-prompt-image-container-remove-button {
    opacity: 1.0;
    background-color: rgba(var(--bs-danger-rgb), 0.5);
    border: 1px solid var(--bs-danger);
}

.alt-prompt-image-container-remove-button:hover {
    opacity: 1.0;
    background-color: rgba(var(--bs-danger-rgb), 0.7) !important;
    border: 1px solid black;
    cursor: pointer;
}

.image-clear-button {
    vertical-align: middle;
    display: inline-block;
}
.param-edit-group-container {
    display: block;
    border-radius: 0.5rem;
    border: 1px solid var(--bs-border-color);
    padding: 0.5rem;
}
.param-edit-container-for-group {
    display: block;
    margin-bottom: 0.5rem;
}
.param-edit-container {
    display: block;
    border-radius: 0.5rem;
    border: 1px solid color-mix(in srgb, var(--bs-body-bg) 70%, var(--bs-border-color));
    padding: 0.2rem;
    margin-left: 1rem;
}
.param-edit-header {
    display: inline-block;
    font-weight: bold;
    margin-right: 0.5rem;
}
.param-edit-part {
    display: inline-block;
    margin-right: 1rem;
}
.param-edit-number {
    width: 3rem;
}
.param-edit-text {
    width: 20rem;
}
.clip-tokenization-input-box {
    margin-top: 1rem;
    width: 90%;
    margin-left: 1rem;
}
.clip-tokenization-block {
    border-radius: 0.5rem;
    display: inline-block;
    padding-left: 0.6rem;
    padding-right: 0.6rem;
    margin: 1px;
    background-color: color-mix(in srgb, var(--bs-body-bg) 70%, var(--bs-warning));
}
.clip-tokenization-word-tweak {
    background-color: color-mix(in srgb, var(--bs-body-bg) 70%, var(--bs-success));
}
.clip-tokenization-wordbreak {
    font-size: 80%;
    color: var(--bs-secondary-color);
}
.clip-tokenization-weight {
    font-size: 70%;
    color: var(--bs-secondary-color);
    float: right;
    padding-top: 0.15rem;
    padding-left: 0.1rem;
}
.image-preview-progress-wrapper {
    position: relative;
    top: 0;
    left: 0;
    width: 100%;
    height: 0;
}
.image-preview-progress-inner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 2px;
}
.image-preview-progress-overall {
    position: absolute;
    z-index: 1;
    top: calc(10rem - 7px);
    left: 0;
    width: 0;
    height: 2px;
    background-color: var(--bs-primary);
}
.image-preview-progress-current {
    position: absolute;
    z-index: 1;
    top: calc(10rem - 5px);
    left: 0;
    width: 0;
    height: 2px;
    background-color: var(--green);
}
.controlnet-preview-result img {
    max-width: 200px;
    max-height: 200px;
    margin-left: 2rem;
}
.wildcard_title {
    font-weight: bold;
    font-size: 150%;
}
.image_editor_input {
    vertical-align: top;
    height: 100%;
}
.image_editor_leftbar {
    margin: 0;
    display: inline-block;
    vertical-align: top;
    width: 52px;
    height: calc(100% - 52px);
}
.image_editor_rightbar {
    margin: 0;
    display: inline-block;
    vertical-align: top;
    width: 52px;
    height: calc(100% - 52px);
}
.image_editor_bottombar {
    margin: 0;
    height: 32px;
    display: block;
    width: 100%;
}
.image-editor-canvas {
    margin: 0;
    display: inline-block;
    vertical-align: top;
}
.image-editor-tool {
    margin: 6px;
    width: 32px;
    height: 32px;
    background-repeat: no-repeat;
    background-position: center;
    background-size: 32px 32px;
    background-color: var(--btn-primary-bg);
    cursor: pointer;
    border: 1px solid var(--btn-primary-border);
    border-radius: 8px;
}
.image-editor-tool:hover {
    background-color: var(--btn-primary-hover-bg);
}
.image-editor-tool-selected {
    background-color: var(--bs-danger);
}
.image-editor-tool-selected:hover {
    background-color: var(--bs-danger);
}
.image-editor-info-bubble-title {
    font-weight: bold;
}
.image-editor-info-bubble-description {
    max-width: 400px;
    white-space: normal;
}
.image-editor-tool-bottombar {
    padding-left: 52px;
    margin: 0;
    height: 32px;
    display: flex;
    width: 100%;
    flex-wrap: nowrap;
    justify-content: space-evenly;
    font-size: 14px;
}
.image-editor-tool-block {
    display: flex;
    flex-grow: 2;
    align-items: baseline;
    border: 1px solid var(--bs-border-color);
    height: 32px;
}
.image_editor_canvaslist {
    display: block;
    margin: 0;
    width: 52px;
}
.image_editor_layer_preview {
    display: block;
    width: 50px;
    height: 50px;
    border: 1px solid var(--bs-border-color);
    margin-bottom: 5px;
    margin-top: 1px;
    cursor: pointer;
}
.image_editor_layer_preview canvas {
    width: 50px;
    height: 50px;
    object-fit: contain;
    object-position: center;
}
.image_editor_layer_preview-active {
    border: 2px solid var(--box-selected-border);
}
.image_editor_layer_preview-active canvas {
    width: 46px;
    height: 46px;
}
.image_editor_layer_preview:hover {
    border: 2px solid var(--box-selected-border-stronger);
}
.image_editor_layer_preview:hover canvas {
    width: 46px;
    height: 46px;
}
.image_editor_layer_info {
    position: relative;
    overflow: visible;
    width: 0;
    height: 0;
    top: -55px;
    margin: 0;
    padding: 0;
    font-size: 70%;
}
.image_editor_layer_info_sub {
    background-color: rgba(0, 0, 0, 0.6);
    width: fit-content;
}
.image_editor_newlayer_button {
    margin: auto;
    text-align: center;
    display: block;
    width: 80%;
    padding-top: 8px;
    padding-bottom: 8px;
    border-radius: 16px;
    margin-bottom: 5px;
    font-size: 9px;
}
.server_logs_container {
    display: block;
    width: 80vw;
    height: calc(90vh - 10rem);
    border: 1px solid var(--bs-border-color);
    border-radius: 1rem;
    padding: 0.5rem;
    overflow: auto;
    font-family: var(--font-monospace);
    margin-left: auto;
    margin-right: auto;
}
.log_message {
    white-space: pre-wrap;
}
.log_message_0 {
    background-color: rgba(255, 255, 255, 0.01);
}
.log_message_1 {
    background-color: rgba(0, 0, 0, 0.01);
}
.lora_extractor_special {
    width: 100%;
    height: 10px;
    position: relative;
}
.lora_extractor_special .image-preview-progress-overall {
    top: 5px;
}
.lora_extractor_special .image-preview-progress-current {
    top: 3px;
}
/* Legacy inline-block layout replaced with flexbox for better responsiveness */
.manage-users-left, .manage-users-right {
    height: calc(100vh - 6rem);
    padding: 0.5rem;
    overflow-y: auto;
}
.manage-users-left {
    margin-left: 0.5rem;
    flex: 0 0 20rem;
    min-width: 20rem;
}
.manage-users-right {
    flex: 1 1 auto;
    min-width: 0; /* Allow flex item to shrink below content size */
}
.manage_user_leftbox_content {
    min-width: 1rem;
    min-height: 3rem;
    margin-bottom: 2rem;
}
.admin-user-manage-name {
    border-radius: 1rem;
    padding-left: 1rem;
    padding-right: 1rem;
    padding-top: 0.3rem;
    padding-bottom: 0.3rem;
    margin: 0.5rem;
    display: block;
    background-color: var(--bs-tertiary-bg);
    cursor: pointer;
    transition: background-color var(--duration-500) var(--ease-out);
}
.admin-user-manage-name:hover {
    background-color: var(--bs-primary);
}
.manage-users-left-header {
    display: flex;
}
.manage-users-left-title {
    font-size: 1.5rem;
    flex-grow: 1;
}
.admin-user-right-titlebar {
    display: inline;
    font-size: 1.5rem;
    margin: 1rem;
}
.admin-user-right-titlebar-name {
    border: 1px dashed var(--bs-border-color);
    padding-left: 0.2rem;
    padding-right: 0.2rem;
}
.admin-user-manage-notice {
    display: inline;
}
.welcome_message {
    margin: auto;
    width: fit-content;
    height: fit-content;
    position: relative;
    top: 50%;
    transform: translateY(-50%);
    font-size: 150%;
    white-space: pre-wrap;
    text-align: center;
    padding: var(--space-6);
    max-width: 600px;
}

.welcome_message::before {
    content: '';
    display: block;
    font-size: 3rem;
    margin-bottom: var(--space-4);
    opacity: 0.6;
}

.welcome_message.generating {
    color: var(--bs-primary);
    font-weight: 600;
}

.welcome_message.generating::before {
    content: '';
    animation: pulse var(--duration-1000) var(--ease-in-out) infinite;
}

.welcome_message.error {
    color: var(--bs-danger);
    font-weight: 600;
}

.welcome_message.error::before {
    content: '';
}

@keyframes pulse {
    0%, 100% { opacity: 0.6; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.1); }
}

/* Empty state for batch gallery */
#current_image_batch:empty::before {
    content: 'No images yet\AStart generating to see your creations here';
    white-space: pre;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    height: 100%;
    min-height: 200px;
    color: var(--bs-secondary-color);
    font-size: var(--text-lg);
    line-height: 2;
    flex-direction: column;
}
.welcome-message-wrapper {
    min-height: 8em;
    width: fit-content;
}
.button-starred-image {
    background-color: var(--star);
    color: black !important;
    box-shadow: 0 0 1px 1px var(--star);
    transition: all var(--duration-500) var(--ease-out);
    border: none;
}
.button-starred-image:hover {
    background-color: orange;
    color: black;
}
.main_inputs_filter {
    width: 100%;
    margin: auto;
    padding-right: 20px;
    margin-bottom: 0.2rem;
}
.card-collection-inline {
    display: block;
    width: fit-content;
    margin: auto;
    text-align: center;
}
.card-collection-inline .card {
    display: inline-block;
    margin: 0.2rem;
    vertical-align: top;
    text-align: left;
}
/* ========================================
   RESPONSIVE BREAKPOINTS
   Mobile and tablet optimizations
   ======================================== */

/* Tablet and below - stack layout */
@media screen and (max-width: 992px) {
    /* Top bar becomes vertical stack */
    .t2i-top-bar,
    #t2i_top_bar {
        flex-direction: column;
    }
    
    /* Input sidebar - full width on tablet */
    .input-sidebar,
    #input_sidebar {
        max-width: 100%;
        width: 100%;
        flex: 0 0 auto;
        max-height: 50vh;
    }
    
    /* Main image area - full width */
    .main-image-area,
    #main_image_area {
        max-width: 100%;
        width: 100%;
        flex: 1 1 auto;
    }
    
    /* Batch wrapper - full width below */
    .current_image_batch,
    #current_image_batch_wrapper {
        max-width: 100%;
        width: 100%;
        flex: 0 0 auto;
        max-height: 300px;
        order: 999; /* Still keep it last */
    }
    
    /* Hide split bars on mobile */
    .t2i-top-split-bar,
    #t2i-top-split-bar,
    #t2i-top-2nd-split-bar {
        display: none;
    }
}

/* Mobile - compact layout */
@media screen and (max-width: 768px) {
    /* Input sidebar - compact */
    .input-sidebar,
    #input_sidebar {
        max-height: 40vh;
    }
    
    /* Prompt region - compact */
    .alt_prompt_region,
    #alt_prompt_region {
        padding: 0.75rem;
    }
    
    /* Prompt buttons - stack vertically */
    .alt-prompt-buttons-wrapper {
        flex-direction: column;
    }
    
    .alt-prompt-buttons {
        width: 100%;
    }
    
    /* Batch gallery - optimized mobile grid (respects user preference with min size) */
    .current_image_batch_core,
    #current_image_batch {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.5rem;
        padding: 0.5rem;
    }

    /* On larger mobile devices, respect the grid column preference */
    @media screen and (min-width: 576px) {
        .current_image_batch_core,
        #current_image_batch {
            grid-template-columns: repeat(min(var(--batch-grid-columns, 3), 4), 1fr);
        }
    }

    /* Mobile tap targets - ensure minimum 44x44px for accessibility */
    .nav-link,
    .btn,
    .basic-button,
    button {
        min-height: 44px;
        min-width: 44px;
        padding: 0.75rem 1rem;
    }

    #bottombartabcollection .nav-link {
        font-size: 0.875rem;
        padding: 0.75rem 1.25rem;
    }

    /* Reduce padding throughout */
    .t2i-top-bar-container {
        padding: 0.25rem;
    }
    
    /* Bottom bar tabs - scrollable on mobile */
    #bottombartabcollection {
        overflow-x: auto;
        overflow-y: hidden;
        flex-wrap: nowrap;
    }
}

/* Small mobile - minimal layout */
@media screen and (max-width: 576px) {
    /* Very compact sidebar */
    .input-sidebar,
    #input_sidebar {
        max-height: 35vh;
    }
    
    /* Compact prompt */
    .alt_prompt_region,
    #alt_prompt_region {
        padding: 0.5rem;
    }
    
    .alt_prompt_textbox,
    #alt_prompt_textbox,
    #alt_negativeprompt_textbox {
        padding: 0.5rem;
        font-size: 0.875rem;
    }
    
    /* Smaller batch grid */
    .current_image_batch_core,
    #current_image_batch {
        grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    }
}
.auto-symbol {
    color:var(--bs-primary);
    margin-right: 0.25rem;
}
.simpletabmainview {
    overflow: hidden;
    height: calc(100% - 0.6rem);
}
.simpletabbrowserwrapper {
    width: 100vw;
    height: calc(100vh - 2rem);
}
.simple-wrapper-flex {
    width: 100%;
    height: calc(100vh - 2rem - 15rem);
    display: flex;
    justify-content: flex-start;
}
.simple-bottom-area {
    width: 100%;
    height: 15rem;
    display: block;
}
.simpleinputsidebar {
    padding-top: 1rem;
    padding-left: 1rem;
    padding-right: 1rem;
    height: 100%;
    min-width: 20rem;
}
.simpleinput-top-section {
    width: 100%;
    height: calc(100% - 5rem);
    overflow: auto;
}
.simpleinputsidebar .auto-input-prompt-tokencount {
    display: none;
}
.simple-gen-button-wrapper {
    display: block;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--bs-border-color);
}
.simple-gen-button-wrapper .generate-button {
    display: block;
    width: 90%;
    margin: auto;
}
.simpleimagearea {
    flex-grow: 10;
    text-align: center;
    padding-top: 20px;
}
.simpleimagearea .loading-spinner {
    top: -60%;
}
.simpleimagearea img {
    max-width: 100%;
    height: calc(100vh - 20rem);
    object-fit: contain;
}
.simpletab-workflow-header {
    display: block;
    text-align: center;
    font-size: 150%;
    font-weight: bold;
}
.simpletabbrowserwrapper .image-preview-text,
.simpletabbrowserwrapper .model-descblock {
    font-size: 100%;
}
.simple-outer-wall {
    height: 100%;
    width: 5px;
    min-width: 5px;
    margin-left: 1rem;
    margin-right: 0;
    background-color: var(--bs-border-color);
}
.simple-vertical-divider {
    height: 5px;
    width: 100%;
    margin: 0;
    background-color: var(--bs-border-color);
}
.simpletab-progress-wrapper .image-preview-progress-inner {
    top: calc(-10rem + 5px);
}
.simple_current_image_batch {
    padding: 1rem;
    display: block;
    overflow-x: auto;
    overflow-y: hidden;
    width: 100%;
    height: 15rem;
    text-align: right;
    white-space: normal;
}
.simple_current_image_batch .image-block {
    margin-left: 0.5rem;
    height: 10rem;
}
.browser-section-loader {
    display: block;
    height: 40rem;
    width: 50%;
}
.model_downloader_metadatazone {
    width: 100%; /* Use Bootstrap grid width instead of fixed calc() */
    max-width: none; /* Let Bootstrap grid handle width */
    max-height: 20rem;
    padding: 1rem;
    border: 1px solid var(--bs-border-color);
    border-radius: 0.5rem;
    overflow: auto;
    display: block; /* Changed from inline-block since it's in Bootstrap grid */
}
.model_downloader_imageside {
    display: inline-block;
    width: 20rem;
    vertical-align: top;
}
.model_downloader_imageside img {
    max-width: 100%;
    max-height: 20rem;
    object-fit: contain;
}
.model_downloader_imageselector {
    text-align: center;
}
.model-downloader-section-wrapper {
    display: block;
    width: fit-content;
    margin: auto;
}
.model-downloader-main-section {
    display: block; /* Changed from inline-block for better responsiveness */
    width: 100%;
    max-width: 70rem; /* Max width but allow shrinking */
    padding-right: 1rem;
    padding-left: 1rem;
}
.model-downloader-right-sidebar {
    display: inline-block;
    vertical-align: top;
    max-width: 42rem;
}
.active-model-download-card {
    display: inline-block;
    width: 20rem;
}
.active-model-download-card img {
    width: 10rem;
    margin-left: 5rem;
    max-height: 10rem;
    object-fit: contain;
}
.active-model-download-card .status-text {
    font-size: 80%;
}
.ext-danger-license {
    background-color: rgba(255, 0, 0, 0.03);
}
.input_filter_container {
    display: flex;
    position: relative;
}
.input_filter_container.bottom_filter {
    display: inline;
}
.input_filter_container.bottom_filter input {
    padding-right: 20px;
}
.clear_input_icon {
    position: absolute;
    right: 5px;
    top: 2px;
    cursor: pointer;
    display: none;
}
.clear_input_icon.bottom_filter {
    top: -1px;
}
.swap_aspectratio_button {
    position: absolute;
    font-size: 18px;
    padding: 0 5px !important;
}
.admin_perm_group {
    display: inline-block;
    border-radius: 0.5rem;
    padding: 0.5rem;
    border: 1px solid var(--bs-border-color);
    margin: 1rem;
}
.prompt-copy-button {
    float: right;
}
.trigger-phrase-copy-button {
    display: inline-flex;
    align-items: center;
    font-size: 90%;
    height: 1.6em;
    padding-top: 0 !important;
}

.backend-list-entry-unavailable {
    opacity: 0.5;
    background-color: rgba(var(--bs-body-bg-rgb), 0.2);
}

.backend-list-entry-error {
    border-left: 5px solid var(--bs-danger);
    background-color: rgba(var(--bs-danger-rgb), 0.1);
}
.backend-list-entry-warning {
    border-left: 5px solid var(--bs-warning);
    background-color: rgba(var(--bs-warning-rgb), 0.1);
}
.backend-list-entry-info {
    border-left: 5px solid var(--bs-info);
    background-color: rgba(var(--bs-info-rgb), 0.1);
}
.backend-list-entry-good {
    border-left: 5px solid var(--bs-success);
}
.backend-list-entry-stale {
    border-left: 5px solid var(--bs-warning);
}
.backend-list-entry-waiting {
    border-left: 1px solid rgba(var(--bs-border-color-rgb), 0.3);
}
.backend-type-label {
    font-weight: bold;
    margin-left: 1rem;
}
.backend-type-label::after {
    content: ':';
}
.backend-log-container {
    display: flex;
    flex-direction: column;
    height: calc(100vh - 10rem);
    overflow-y: auto;
    padding: 0.5rem;
}
.backend-log-line {
    display: flex;
    align-items: center;
    padding: 0.2rem;
    border-radius: 0.3rem;
    margin-bottom: 0.2rem;
}
.backend-log-line:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.1);
}
.backend-log-level {
    width: 4rem;
    text-align: right;
    padding-right: 0.5rem;
    font-weight: bold;
}
.backend-log-message {
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.backend-log-time {
    opacity: 0.7;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
}
.backend-log-error {
    color: var(--bs-danger);
}
.backend-log-warning {
    color: var(--bs-warning);
}
.backend-log-info {
    color: var(--bs-info);
}
.backend-log-success {
    color: var(--bs-success);
}
.backend-log-auto-scroll-button {
    position: absolute;
    right: 1rem;
    top: 0.5rem;
    background-color: rgba(var(--bs-body-bg-rgb), 0.5);
    border-radius: 0.5rem;
    padding: 0.2rem;
    cursor: pointer;
}
.backend-log-auto-scroll-button:hover {
    background-color: var(--bs-primary);
}
.image-history-jumper {
    width: 100%;
    height: 20px;
    border: 1px solid rgba(var(--bs-border-color-rgb, 128, 128, 128), 0.7);
    background-color: rgba(var(--bs-body-bg-rgb), 0.7);
    color: var(--bs-body-color);
    border-radius: 5px;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
}
.wildcard-list-item {
    padding: 0.5rem;
    border-radius: 0.5rem;
    margin-bottom: 0.2rem;
}
.wildcard-list-item:hover {
    cursor: pointer;
    background-color: rgba(var(--yellow-rgb), 0.7);
}
.wildcard-list-item.selected {
    background-color: rgba(var(--green-rgb), 0.7);
}

#modal_presets_list {
    max-height: calc(90vh - 10rem);
    overflow-y: auto;
    padding-right: 0.5rem;
    padding-left: 0.5rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    border-radius: 0.5rem;
    border: 1px solid var(--bs-border-color);
    background-color: var(--bs-body-bg);
}
.modal-preset-item {
    display: flex;
    align-items: center;
    padding: 0.5rem;
    border-radius: 0.5rem;
    margin-bottom: 0.2rem;
    cursor: pointer;
}
.modal-preset-item:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.1);
}
.modal-preset-item.selected {
    background-color: rgba(var(--green-rgb), 0.7);
}
.modal-preset-item .preset-name {
    flex-grow: 1;
    margin-right: 0.5rem;
    font-weight: bold;
}
.modal-preset-item .preset-description {
    flex-grow: 2;
    margin-right: 0.5rem;
    color: var(--bs-secondary-color);
    font-size: 90%;
}
.modal-preset-item .preset-params {
    flex-grow: 1;
    margin-right: 0.5rem;
    color: var(--bs-secondary-color);
    font-size: 90%;
    text-align: right;
}
.modal-preset-item .preset-remove-button {
    color: var(--bs-danger);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-remove-button:hover {
    color: rgba(var(--bs-danger-rgb), 0.7);
}
.modal-preset-item .preset-add-button {
    background-color: var(--bs-primary);
    color: white;
    padding: 0.2rem 0.5rem;
    border-radius: 0.3rem;
    font-weight: bold;
    cursor: pointer;
    transition: background-color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-add-button:hover {
    background-color: rgba(var(--bs-primary-rgb), 0.8);
}
.modal-preset-item .preset-add-button.selected {
    background-color: rgba(var(--green-rgb), 0.7);
}
.modal-preset-item .preset-add-button.disabled {
    background-color: var(--bs-secondary-bg);
    color: var(--bs-secondary-color);
    cursor: not-allowed;
}
.modal-preset-item .preset-add-button.disabled:hover {
    background-color: var(--bs-secondary-bg);
}
.modal-preset-item .preset-duplicate-button {
    color: var(--bs-info);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-duplicate-button:hover {
    color: rgba(var(--bs-info-rgb), 0.7);
}
.modal-preset-item .preset-export-button {
    color: var(--bs-success);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-export-button:hover {
    color: rgba(var(--bs-success-rgb), 0.7);
}
.modal-preset-item .preset-import-button {
    color: var(--bs-warning);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-import-button:hover {
    color: rgba(var(--bs-warning-rgb), 0.7);
}
.modal-preset-item .preset-download-button {
    color: var(--bs-danger);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-download-button:hover {
    color: rgba(var(--bs-danger-rgb), 0.7);
}
.modal-preset-item .preset-upload-button {
    color: var(--bs-primary);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-upload-button:hover {
    color: rgba(var(--bs-primary-rgb), 0.8);
}
.modal-preset-item .preset-info-button {
    color: var(--bs-secondary-color);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-info-button:hover {
    color: rgba(var(--bs-secondary-color-rgb), 0.7);
}
.modal-preset-item .preset-params-button {
    color: var(--bs-secondary-color);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-params-button:hover {
    color: rgba(var(--bs-secondary-color-rgb), 0.7);
}
.modal-preset-item .preset-advanced-button {
    color: var(--bs-secondary-color);
    font-weight: bold;
    cursor: pointer;
    transition: color var(--duration-300) var(--ease-in-out);
}
.modal-preset-item .preset-advanced-button:hover {
    color: rgba(var(--bs-secondary-color-rgb), 0.7);
}
.modal-preset-item .preset-label {
    display: inline-block;
    padding: 0.1rem 0.3rem;
    border-radius: 0.3rem;
    margin-right: 0.5rem;
    font-size: 80%;
    font-weight: normal;
    color: white;
}
.modal-preset-item .preset-label.tag-success {
    background-color: var(--bs-success);
}
.modal-preset-item .preset-label.tag-info {
    background-color: var(--bs-info);
}
.modal-preset-item .preset-label.tag-warning {
    background-color: var(--bs-warning);
}
.modal-preset-item .preset-label.tag-danger {
    background-color: var(--bs-danger);
}
.modal-preset-item .preset-label.tag-primary {
    background-color: var(--bs-primary);
}
.modal-preset-item .preset-label.tag-secondary {
    background-color: var(--bs-secondary);
}
.modal-preset-item .preset-label.tag-light {
    background-color: var(--bs-border-color);
}
.modal-preset-item .preset-label.tag-dark {
    background-color: rgba(0, 0, 0, 0.7);
}
.modal-preset-item .preset-label.tag-pending {
    background-color: rgba(255, 255, 0, 0.7);
}
.modal-preset-item .preset-label.tag-processing {
    background-color: rgba(0, 255, 255, 0.7);
}
.modal-preset-item .preset-label.tag-completed {
    background-color: rgba(0, 255, 0, 0.7);
}
.modal-preset-item .preset-label.tag-failed {
    background-color: rgba(255, 0, 0, 0.7);
}
.modal-preset-item .preset-label.tag-canceled {
    background-color: rgba(128, 128, 128, 0.7);
}
.modal-preset-item .preset-label.tag-unknown {
    background-color: rgba(255, 255, 255, 0.7);
}
.modal-preset-item .preset-label.tag-default {
    background-color: rgba(0, 0, 0, 0.1);
}

/* ========================================
   LOADING STATES & SKELETON SCREENS
   Animated loading placeholders
   ======================================== */

/* Skeleton loader animation */
.skeleton-loader {
    background: linear-gradient(
        90deg,
        var(--bs-secondary-bg) 25%,
        var(--bs-tertiary-bg) 50%,
        var(--bs-secondary-bg) 75%
    );
    background-size: 200% 100%;
    animation: skeleton-loading var(--duration-1000) var(--ease-in-out) infinite;
    border-radius: var(--radius-md);
}

@keyframes skeleton-loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* Skeleton variants */
.skeleton-text {
    height: 1rem;
    margin-bottom: var(--space-2);
}

.skeleton-title {
    height: 1.5rem;
    width: 60%;
    margin-bottom: var(--space-3);
}

.skeleton-avatar {
    width: 3rem;
    height: 3rem;
    border-radius: var(--radius-full);
}

.skeleton-card {
    height: 10rem;
    margin-bottom: var(--space-4);
}

/* Loading state for select elements */
.loading {
    position: relative;
    pointer-events: none;
    opacity: 0.6;
}

/* ========================================
   KEYBOARD SHORTCUTS MODAL STYLES
   ======================================== */

.shortcuts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-6);
}

.shortcuts-section h6 {
    color: var(--bs-primary);
    font-weight: 600;
    margin-bottom: var(--space-3);
    font-size: var(--text-sm);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.shortcut-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-2) 0;
    border-bottom: 1px solid var(--bs-border-color);
}

.shortcut-row:last-child {
    border-bottom: none;
}

.shortcut-row kbd {
    background-color: var(--bs-tertiary-bg);
    border: 1px solid var(--bs-border-color);
    border-radius: 0.25rem;
    padding: 0.25rem 0.5rem;
    font-family: var(--bs-font-monospace);
    font-size: var(--text-xs);
    font-weight: 600;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    margin: 0 0.25rem;
}

.shortcut-row span {
    color: var(--bs-body-color);
    font-size: var(--text-sm);
    flex: 1;
    text-align: right;
}

.loading::after {
    content: '';
    position: absolute;
    right: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
    width: 1rem;
    height: 1rem;
    border: 2px solid var(--bs-border-color);
    border-top-color: var(--bs-primary);
    border-radius: 50%;
    animation: spin var(--duration-1000) linear infinite;
}

@keyframes spin {
    to { transform: translateY(-50%) rotate(360deg); }
}

/* ========================================
   KEYBOARD SHORTCUTS & UX IMPROVEMENTS
   ======================================== */

/* Prompt history dropdown */
.prompt-history-button {
    flex-shrink: 0;
}

.prompt-history-dropdown {
    background-color: var(--bs-body-bg);
    border: 1px solid var(--bs-border-color);
    border-radius: 0.375rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    padding: 0.25rem 0;
}

.prompt-history-item {
    padding: 0.75rem 1rem;
    display: block;
    text-decoration: none;
    color: var(--bs-body-color);
    border-bottom: 1px solid var(--bs-border-color);
    transition: background-color var(--duration-200) var(--ease-in-out);
}

.prompt-history-item:last-child {
    border-bottom: none;
}

.prompt-history-item:hover {
    background-color: var(--bs-tertiary-bg);
    color: var(--bs-body-color);
}

.prompt-history-item:active {
    background-color: var(--bs-secondary-bg);
}

/* Empty state messages */
.empty-state-message {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Status bar expanded view */
.status-bar-expanded {
    font-size: 0.875rem;
    line-height: 1.5;
}

.status-bar-expanded strong {
    color: var(--bs-primary);
    margin-right: 0.5rem;
}

/* Auto-expanding textarea improvements */
.alt_prompt_textbox,
#alt_prompt_textbox,
#alt_negativeprompt_textbox {
    transition: height var(--duration-200) var(--ease-in-out);
}

/* Keyboard shortcuts modal improvements */
.keyboard-shortcuts-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.shortcut-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    border-bottom: 1px solid var(--bs-border-color);
    transition: background-color var(--duration-200) var(--ease-in-out);
}

.shortcut-item:hover {
    background-color: var(--bs-tertiary-bg);
}

.shortcut-item:last-child {
    border-bottom: none;
}

.shortcut-item kbd {
    background-color: var(--bs-secondary-bg);
    border: 1px solid var(--bs-border-color);
    border-radius: 0.25rem;
    padding: 0.25rem 0.5rem;
    font-family: 'Courier New', Courier, monospace;
    font-size: 0.875rem;
    font-weight: 600;
    min-width: 2.5rem;
    text-align: center;
    display: inline-block;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.1);
    color: var(--bs-body-color);
}

.shortcut-item span {
    flex: 1;
    color: var(--bs-body-color);
}
