@model GeneratePageModel

<div class="d-flex flex-column h-100" style="min-height: 100vh;">
    <div id="t2i_top_bar" class="mb-2"></div>
    <div class="row g-3 flex-grow-1" style="flex-shrink: 0;">
        <!-- Parameter Sidebar -->
        <div class="col-md-3 border-end" id="input_sidebar">
            <div class="p-3 h-100 d-flex flex-column">
                <ul class="nav nav-tabs swarm-gen-tab-subnav mb-2" data-title="Left Sidebar" data-content="inputsidebartab_content" role="tablist" id="inputsidebartabcollection">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active translate" data-bs-toggle="tab" href="#Input-Sidebar-Main-Tab" aria-selected="true" role="tab">Inputs</a>
                    </li>
                </ul>
                <div class="tab-content flex-grow-1 overflow-hidden" id="inputsidebartab_content">
                    <div class="tab-pane show active genpage-bottom-tab h-100 d-flex flex-column" id="Input-Sidebar-Main-Tab" role="tabpanel">
                        <div class="main_inputs_area_wrapper flex-grow-1 d-flex flex-column overflow-hidden" id="main_inputs_area_wrapper">
                            <div class="input_filter_container p-2">
                                <div class="input-group">
                                    <input type="text" class="form-control auto-text" id="main_inputs_filter" oninput="hideUnsupportableParams()" placeholder="Filter parameters..." />
                                    <button class="btn btn-outline-secondary" type="button" id="clear_input_icon" onclick="clearParamFilterInput()">&#x2715;</button>
                                </div>
                            </div>
                            <div id="main_inputs_area"></div>
                            <div id="main_inputs_area_hidden" class="main_inputs_area_hidden"></div>
                        </div>
                        <div class="advanced_input_checkbox form-check text-center mt-auto p-3 border-top bg-body-secondary">
                            <input class="form-check-input" type="checkbox" id="advanced_options_checkbox" onclick="toggle_advanced()"/>
                            <label class="form-check-label" for="advanced_options_checkbox" onclick="toggle_advanced_checkbox_manual()"><span class="translate">Display Advanced Options?</span> <span id="advanced_hidden_count"></span></label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="col-md-9 d-flex flex-column">
            <div class="row g-0 flex-grow-1">
                <!-- Image Result -->
                <div class="col-md-8 border-end" id="main_image_area">
                    <div class="d-flex flex-column h-100">
<ul class="nav nav-tabs swarm-gen-tab-subnav mb-2" data-title="Center Area" data-content="currentimagecontent" role="tablist" id="currentimagecollection">
                            <li class="nav-item" role="presentation">
                                <a class="nav-link active translate" data-bs-toggle="tab" href="#Image-Result-Tab" aria-selected="true" role="tab">Image</a>
                            </li>
                        </ul>
                <div class="tab-content flex-grow-1" id="currentimagecontent">
                    <div class="tab-pane show active genpage-bottom-tab h-100" id="Image-Result-Tab" role="tabpanel">
                        <div class="image_editor_input" id="image_editor_input" style="display:none;"></div>
                        <div id="image_editor_sizebar" style="display:none;"></div>
                        <div id="current_image_wrapbox">
                            <div class="current_image drag_image_target" id="current_image">
                                <div id="welcome_message" class="welcome_message">@(new HtmlString(Program.VersionUpdateMessage ?? (Program.ServerSettings.ShowExperimentalFeatures ? "Experimental Features are enabled. Issue reports will not be accepted." : Program.ServerSettings.UI.OverrideWelcomeMessage)))</div>
                            </div>
                        </div>
                    </div>
                    <div id="extra_welcome_message">@(new HtmlString(Program.ServerSettings.UI.ExtraWelcomeInfo))</div>
                </div>
                        <!-- Prompt Bar -->
<div class="alt_prompt_region drag_image_target bg-body-tertiary border-top border-bottom shadow-sm" id="alt_prompt_region">
                            <div id="alt_prompt_extra_area" class="alt_prompt_extra_area p-2">
                                <button class="btn btn-sm btn-danger image-clear-button translate" style="display: none;" id="alt_prompt_image_clear_button">Clear Images</button>
                                <div class="added-image-area alt-prompt-added-image-area" id="alt_prompt_image_area"></div>
                            </div>
                            <div class="p-3">
                                <div class="alt_prompt_main_line d-flex gap-2 mb-2">
                                    <button class="btn btn-outline-primary alt-text-add-button" id="alt_text_add_button" title="Add prompt helper" aria-label="Add prompt helper">+</button>
                                    <div class="flex-grow-1">
                                        <textarea id="alt_prompt_textbox" class="form-control alt_prompt_textbox translate mb-2" rows="2" placeholder="Type your prompt here... (or, drag/paste an image in to use Image Prompting)" onpaste="imagePromptImagePaste(arguments[0])"></textarea>
                                        <textarea id="alt_negativeprompt_textbox" class="form-control alt_prompt_textbox translate" rows="1" placeholder="Optionally, type a negative prompt here..."></textarea>
                                    </div>
                                    <div class="d-flex flex-column gap-1">
                                        <button class="btn btn-success alt-prompt-generate-button translate" id="alt_generate_button" title="Generate" aria-label="Generate" oncontextmenu="doPopover('generate'); return false;" onclick="mainGenHandler.doGenerateButton(event)">Generate</button>
                                        <div class="d-flex gap-1">
                                            <button class="btn btn-secondary btn-sm alt-prompt-center-button" id="alt_center_button" title="Generate options" aria-label="Generate options" oncontextmenu="doPopover('generate_center'); return false;" onclick="doPopover('generate_center')">&#x2B9F;</button>
                                            <button class="btn btn-danger btn-sm alt-interrupt" id="alt_interrupt_button" title="Interrupt" aria-label="Interrupt" oncontextmenu="doPopover('interrupt'); return false;" onclick="mainGenHandler.doInterrupt()">&times;</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Token count displays required by layout.js -->
                            <div class="alt-text-tokencount-wrapper">
                                <span id="alt_text_tokencount" class="alt-text-tokencount"></span>
                                <span id="alt_negtext_tokencount" class="alt-text-tokencount" style="display:none"></span>
                            </div>
                            <!-- Popovers expected by ui_improvements.js for prompt actions -->
                            <div class="sui-popover sui-info-popover" id="popover_generate_center" data-visible="false">
                                <b class="translate">Generate options</b><br>
                                <span class="translate">This opens generation-related quick actions.</span>
                            </div>
                            <div class="sui-popover sui-info-popover" id="popover_generate" data-visible="false">
                                <b class="translate">Generate</b><br>
                                <span class="translate">Start generation with the current settings.</span>
                            </div>
                            <div class="sui-popover sui-info-popover" id="popover_interrupt" data-visible="false">
                                <b class="translate">Interrupt</b><br>
                                <span class="translate">Stop the current generation job(s).</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Batch Sidebar -->
                <div class="col-md-4">
                    <div class="d-flex flex-column h-100">
<ul class="nav nav-tabs swarm-gen-tab-subnav mb-2" data-title="Right Sidebar" data-content="rightsidebarcontent" role="tablist" id="rightsidebarcollection">
                            <li class="nav-item" role="presentation">
                                <a class="nav-link active translate" data-bs-toggle="tab" href="#Image-Batch-Tab" aria-selected="true" role="tab">Batch</a>
                            </li>
                        </ul>
                        <div class="tab-content flex-grow-1" id="rightsidebarcontent">
                            <div class="tab-pane show active genpage-bottom-tab h-100" id="Image-Batch-Tab" role="tabpanel">
                                <div class="position-relative">
                                    <button class="btn btn-sm batch-gear-button" onclick="doPopover('batchgear')">&#9881;</button>
                                </div>
                                <div id="current_image_batch_wrapper">
                                    <div id="current_image_batch" class="current_image_batch_core"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Bar -->
<div class="row g-3" id="t2i_bottom_bar">
        <div class="col-12">
<div class="bottom-info-bar-container d-flex flex-wrap align-items-center gap-2 p-2 border-bottom" id="bottom_info_bar">
                <span class="bottom-info-bar-component p-1 border-start"><span class="other_info_span" id="other_info_span"></span></span>
                <span class="bottom-info-bar-component p-1 border-start"><b class="translate">Model</b>: <select class="form-select form-select-sm auto-dropdown current_model_view" onchange="autoSelectWidth(this)" id="current_model"></select></span>
                <span class="bottom-info-bar-component p-1 border-start" style="display:none;" id="current_presets_wrapper"><span><b class="translate">Current presets</b><span id="preset_info_slot"></span>: </span> <span id="current_preset_list_view"></span></span>
                <span class="bottom-info-bar-component p-1 border-start" style="display:none;" id="current_loras_wrapper"><span class="translate"><b>Current LoRAs</b><span id="lora_info_slot"></span>: </span> <span id="current_lora_list_view"></span></span>
                <span class="bottom-info-bar-component p-1 border-start ms-auto"><span class="num_jobs_span" id="num_jobs_span"></span></span>
            </div>
            <ul class="nav nav-tabs swarm-gen-tab-subnav" data-title="Bottom Bar" data-content="t2i_bottom_bar_content" role="tablist" id="bottombartabcollection">
                <li class="nav-item" role="presentation">
                    <a class="nav-link active translate" id="imagehistorytabclickable" data-bs-toggle="tab" href="#Image-History-Tab" aria-selected="true" role="tab">Image History</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Presets-Tab" aria-selected="false" tabindex="-1" role="tab">Presets</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Models-Tab" id="modelstabheader" aria-selected="false" tabindex="-1" role="tab">Models</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Vaes-Tab" aria-selected="false" tabindex="-1" role="tab">VAEs</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Loras-Tab" aria-selected="false" tabindex="-1" role="tab">LoRAs</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Embeddings-Tab" aria-selected="false" tabindex="-1" role="tab">Embeddings</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#ControlNets-Tab" aria-selected="false" tabindex="-1" role="tab">ControlNets</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Wildcards-Tab" aria-selected="false" tabindex="-1" role="tab">Wildcards</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link translate" data-bs-toggle="tab" href="#Tools-Tab" aria-selected="false" tabindex="-1" role="tab">Tools</a>
                </li>
            </ul>
            <div class="tab-content" id="t2i_bottom_bar_content">
                <div class="tab-pane show active genpage-bottom-tab" id="Image-History-Tab" role="tabpanel">
                    <div class="browser_container" id="image_history"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Presets-Tab" role="tabpanel">
                    <div class="browser_container preset_list_container" id="preset_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Models-Tab" role="tabpanel">
                    <div class="browser_container" id="model_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Vaes-Tab" role="tabpanel">
                    <div class="browser_container" id="vae_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Loras-Tab" role="tabpanel">
                    <div class="browser_container" id="lora_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Embeddings-Tab" role="tabpanel">
                    <div class="browser_container" id="embedding_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="ControlNets-Tab" role="tabpanel">
                    <div class="browser_container" id="controlnet_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Wildcards-Tab" role="tabpanel">
                    <div class="browser_container" id="wildcard_list"></div>
                </div>
                <div class="tab-pane genpage-bottom-tab" id="Tools-Tab" role="tabpanel">
                    <div class="d-flex align-items-center gap-2 mb-2">
                        <select class="form-select tool-selector flex-grow-1" id="tool_selector">
                            <option value="" selected></option>
                        </select>
                        <button class="btn btn-outline-secondary btn-sm" id="clear_selected_tool_button" style="display:none;" onclick="disableSelectedTool()">Clear</button>
                    </div>
                    <div class="tool-container" id="tool_container">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Split bars expected by layout.js (placeholders) -->
    <div id="t2i-top-split-bar" style="display:none;"></div>
    <div id="t2i-top-2nd-split-bar" style="display:none;"></div>
    <div id="t2i-top-split-quickbutton" style="display:none;"></div>
    <div id="t2i-mid-split-bar" style="display:none;"></div>
    <div id="t2i-mid-split-quickbutton" style="display:none;"></div>
    <button id="quicktools-button" class="d-none" type="button"></button>
    <!-- Hidden control checkboxes required by currentimagehandler.js -->
    <div id="batch_controls_hidden" class="d-none">
        <input type="checkbox" id="auto_clear_batch_checkbox" />
        <input type="checkbox" id="auto_load_previews_checkbox" />
        <input type="checkbox" id="auto_load_images_checkbox" />
        <input type="checkbox" id="show_load_spinners_checkbox" />
        <input type="checkbox" id="separate_batches_checkbox" />
    </div>
    <!-- Safety placeholder for expected inputs -->
    <div id="input_images" class="d-none">1</div>
</div>

@await Html.PartialAsync("GenTabModals.cshtml", Model)
