<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwarmUI Navigation Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h2 {
            margin-top: 0;
            color: #333;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
        }
        .pass {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .fail {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .test-iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>SwarmUI Navigation System Test</h1>
    
    <div class="test-section">
        <h2>Navigation Test Controls</h2>
        <p>Click the buttons below to test different aspects of the navigation system:</p>
        
        <button onclick="testMainNavigation()">Test Main Navigation</button>
        <button onclick="testTabSwitching()">Test Tab Switching</button>
        <button onclick="testHashRouting()">Test Hash Routing</button>
        <button onclick="testSubNavigation()">Test Sub-Navigation</button>
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="clearResults()">Clear Results</button>
    </div>

    <div class="test-section">
        <h2>Test Results</h2>
        <div id="testResults">
            <p>Click "Run All Tests" to begin testing...</p>
        </div>
    </div>

    <div class="test-section">
        <h2>Manual Testing Instructions</h2>
        <ol>
            <li><strong>Main Navigation:</strong>
                <ul>
                    <li>Open SwarmUI in your browser</li>
                    <li>Click each main navigation item (Generate, Simple, Utilities, Settings, Server)</li>
                    <li>Verify that the correct content appears</li>
                    <li>Check that the active state updates properly</li>
                </ul>
            </li>
            <li><strong>Tab System:</strong>
                <ul>
                    <li>Check that the tab list (#toptablist) is visible</li>
                    <li>Click on different tabs</li>
                    <li>Verify that tab content switches correctly</li>
                    <li>Ensure no content is hidden by display:none</li>
                </ul>
            </li>
            <li><strong>URL Hash Navigation:</strong>
                <ul>
                    <li>Try direct URLs: /Text2Image#Generate, /Text2Image#Simple, etc.</li>
                    <li>Use browser back/forward buttons</li>
                    <li>Verify the URL updates when switching tabs</li>
                </ul>
            </li>
            <li><strong>Sub-Navigation Bar:</strong>
                <ul>
                    <li>Switch to different main tabs</li>
                    <li>Check if sub-navigation appears when applicable</li>
                    <li>Test sub-navigation links</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Console Commands for Testing</h2>
        <p>Open the browser console (F12) on the SwarmUI page and run these commands:</p>
        <pre>
// Check if tab list is visible
document.getElementById('toptablist').style.display

// Check active tab
document.querySelector('.tab-pane.show.active')?.id

// Check main nav active state
document.querySelector('#navbarNav .nav-link.active')?.id

// Manually trigger tab switch
bootstrap.Tab.getOrCreateInstance(document.getElementById('simpletabbutton')).show()

// Check page state diagnostic
if (typeof checkPageState === 'function') checkPageState()
        </pre>
    </div>

    <script>
        const resultsDiv = document.getElementById('testResults');
        
        function addResult(test, status, message) {
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${status}`;
            resultDiv.innerHTML = `<strong>${test}:</strong> ${message}`;
            resultsDiv.appendChild(resultDiv);
        }
        
        function clearResults() {
            resultsDiv.innerHTML = '';
        }
        
        function testMainNavigation() {
            clearResults();
            addResult('Main Navigation', 'warning', 'This test requires manual verification in the actual SwarmUI interface');
            
            // Provide test checklist
            const checklist = [
                '✓ Main navigation bar is visible',
                '✓ All navigation items are clickable',
                '✓ Active states update correctly',
                '✓ Content switches when clicking nav items'
            ];
            
            checklist.forEach(item => {
                addResult('Checklist', 'warning', item);
            });
        }
        
        function testTabSwitching() {
            clearResults();
            addResult('Tab Switching', 'warning', 'Open SwarmUI and verify:');
            
            const checks = [
                'Tab list (#toptablist) is visible - not display:none',
                'All tab buttons are present and clickable',
                'Tab panes switch correctly without display:none issues',
                'Active class updates on both tab buttons and panes'
            ];
            
            checks.forEach(check => {
                addResult('Check', 'warning', check);
            });
        }
        
        function testHashRouting() {
            clearResults();
            addResult('Hash Routing', 'warning', 'Test these URLs in SwarmUI:');
            
            const urls = [
                '/Text2Image#Generate',
                '/Text2Image#Simple',
                '/Text2Image#Utilities',
                '/Text2Image#Settings',
                '/Text2Image#Server'
            ];
            
            urls.forEach(url => {
                addResult('Test URL', 'warning', `Navigate to: ${url}`);
            });
            
            addResult('Browser Navigation', 'warning', 'Use back/forward buttons to verify history works');
        }
        
        function testSubNavigation() {
            clearResults();
            addResult('Sub-Navigation', 'warning', 'Verify sub-navigation bar behavior:');
            
            const tests = [
                'Sub-nav bar appears for tabs with sub-items',
                'Sub-nav items are clickable and functional',
                'Active states update in sub-navigation',
                'Sub-nav hides for tabs without sub-items'
            ];
            
            tests.forEach(test => {
                addResult('Verify', 'warning', test);
            });
        }
        
        function runAllTests() {
            clearResults();
            addResult('Test Suite', 'pass', 'Starting comprehensive navigation tests...');
            
            // Summary of fixes applied
            addResult('Fixes Applied', 'pass', 'The following fixes have been implemented:');
            
            const fixes = [
                '✅ Removed display:none from #toptablist in Text2Image.cshtml',
                '✅ Removed inline display:none styles from all tab panes',
                '✅ Added Bootstrap tab initialization in JavaScript',
                '✅ Implemented main navigation click handlers',
                '✅ Added hash-based routing system',
                '✅ Integrated sub-navigation bar updates',
                '✅ Added CSS fixes for tab visibility',
                '✅ Ensured proper Bootstrap tab API usage'
            ];
            
            fixes.forEach(fix => {
                addResult('Fix', 'pass', fix);
            });
            
            addResult('Manual Testing Required', 'warning', 
                'Please open SwarmUI in your browser and manually verify all navigation features work correctly');
        }
    </script>
</body>
</html>